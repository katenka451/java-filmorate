CREATE TABLE IF NOT EXISTS users (
	id LONG GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	email VARCHAR NOT NULL,
	login VARCHAR NOT NULL,
	name VARCHAR NOT NULL,
	birthday DATE,
	CONSTRAINT users_pk PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS MPA (
	id LONG GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	name VARCHAR NOT NULL,
	CONSTRAINT mpa_pk PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS films (
	id LONG GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	name VARCHAR NOT NULL,
	description VARCHAR,
	release_date DATE,
	duration INTEGER,
	mpa_id INTEGER REFERENCES MPA (id),
	CONSTRAINT film_pk PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS friendship (
	user_id LONG NOT NULL REFERENCES users (id),
	friend_id LONG NOT NULL REFERENCES users (id),
	CONSTRAINT friendship_pk PRIMARY KEY (user_id,friend_id)
);

CREATE TABLE IF NOT EXISTS genre (
	id LONG GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	name VARCHAR NOT NULL,
	CONSTRAINT genre_pk PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS filmgenres (
	film_id LONG NOT NULL REFERENCES films (id),
	genre_id LONG NOT NULL REFERENCES genre (id),
	CONSTRAINT filmgenres_pk PRIMARY KEY (film_id,genre_id)
);

CREATE TABLE IF NOT EXISTS likes (
	film_id LONG NOT NULL REFERENCES films (id),
	user_id LONG NOT NULL REFERENCES users (id),
	CONSTRAINT likes_pk PRIMARY KEY (user_id,film_id)
);
